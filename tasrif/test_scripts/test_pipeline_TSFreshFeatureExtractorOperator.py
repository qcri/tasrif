# ---
# jupyter:
#   jupytext:
#     formats: ipynb,py:light
#     text_representation:
#       extension: .py
#       format_name: light
#       format_version: '1.5'
#       jupytext_version: 1.11.2
#   kernelspec:
#     display_name: Python 3
#     language: python
#     name: python3
# ---

# +
import numpy as np
import pandas as pd

from tasrif.processing_pipeline.tsfresh import TSFreshFeatureExtractorOperator

df = pd.DataFrame(
    [
        ["2020-02-16 15:15:00", 98.86667, 105.0, 105.0, 105.0, 282.5, 0],
        ["2020-02-16 15:30:00", 87.26667, 94.0, 94.0, 94.0, 275.0, 0],
        ["2020-02-16 15:45:00", 94.53333, 94.0, 94.0, 94.0, 250.0, 0],
        ["2020-02-16 16:00:00", 86.666664, 95.0, 95.0, 95.0, 235.0, 0],
        ["2020-02-16 16:15:00", 86.86667, 84.0, 84.0, 84.0, 206.5, 0],
        ["2020-02-16 16:30:00", 88.53333, 101.0, 101.0, 101.0, 191.0, 0],
        ["2020-02-16 16:45:00", 76.066666, 68.0, 68.0, 68.0, 166.5, 0],
        ["2020-02-19 08:00:00", 85.333336, 100.0, 100.0, 100.0, 108.0, 1],
        ["2020-02-19 08:15:00", 86.933334, 83.0, 83.0, 83.0, 110.0, 1],
        ["2020-02-19 08:30:00", 86.73333, 84.0, 84.0, 84.0, 116.0, 1],
        ["2020-02-19 08:45:00", 93.066666, 84.0, 84.0, 84.0, 163.0, 1],
        ["2020-02-19 09:00:00", 95.13333, 98.0, 98.0, 98.0, 183.5, 1],
        ["2020-02-19 09:15:00", 89.2, 110.0, 110.0, 110.0, 177.0, 1],
        ["2020-02-19 09:30:00", 85.933334, 79.0, 79.0, 79.0, 171.0, 1],
        ["2020-02-21 00:15:00", 88.6, 103.0, 103.0, 103.0, 153.0, 2],
        ["2020-02-21 00:30:00", 83.53333, 85.0, 85.0, 85.0, 139.0, 2],
        ["2020-02-21 00:45:00", 86.2, 84.0, 84.0, 84.0, 131.0, 2],
        ["2020-02-21 01:00:00", 85.933334, 82.0, 82.0, 82.0, 124.0, 2],
        ["2020-02-21 01:15:00", 88.933334, 89.0, 89.0, 89.0, 120.0, 2],
        ["2020-02-21 01:30:00", 78.53333, 77.0, 77.0, 77.0, 119.0, 2],
        ["2020-02-21 01:45:00", 76.13333, 79.0, 79.0, 79.0, 116.0, 2],
    ],
    columns=["dateTime", "HeartRate", "Calories", "Steps", "Distance", "CGM", "seq_id"],
)

df["dateTime"] = pd.to_datetime(df["dateTime"])
# -

df

operator = TSFreshFeatureExtractorOperator(
    seq_id_col="seq_id", date_feature_name="dateTime", value_col="Steps"
)
features = operator.process(df)[0]
features[features.columns[2:4]]
